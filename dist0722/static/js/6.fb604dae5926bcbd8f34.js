webpackJsonp([6],{"31FK":function(e,t){},Ejdv:function(e,t){},XA1F:function(e,t){},jUlT:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={data:function(){return{messageList:[],total:10,totalPage:"",pageSize:"",currentPage:1}},methods:{getData:function(e,t){var a=this;this.messageList=[],this.$http.get(e,t).then(function(e){a.total=e.data.data.total,a.totalPage=e.data.data.totalPage,a.pageSize=e.data.data.pageSize,a.currentPage=e.data.data.page;var t=e.data.data.rows;t.length>0&&(a.messageList=t,a.messageList.forEach(function(e,t){e.sendTime=a.getTimeStyle(e.sendTime)}))})},handleCurrentChange:function(e){var t=new URLSearchParams;t.append("page",e),t.append("userId",1),this.getData("/api/message/notice_list",{params:t})}},mounted:function(){var e=new URLSearchParams;e.append("userId",1),this.getData("/api/message/notice_list",{params:e})}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"messagePage"},[a("div",{attrs:{id:"countNum"}},[a("p",[e._v("共有"),a("span",[e._v(e._s(e.total))]),e._v("条")])]),e._v(" "),a("div",{staticClass:"tabs-data"},[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:e.messageList}},[a("el-table-column",{attrs:{prop:"msgType",label:"服务类型",width:"185"}}),e._v(" "),a("el-table-column",{attrs:{prop:"msgDetails",label:"短信内容",width:"830"}}),e._v(" "),a("el-table-column",{attrs:{prop:"sendTime",label:"发送时间",width:"177"}})],1),e._v(" "),a("el-pagination",{attrs:{background:"",total:e.total,layout:"prev, pager, next","current-page":e.currentPage},on:{"current-change":e.handleCurrentChange}})],1)])},staticRenderFns:[]};var i={data:function(){return{messageTemplateList:[],total:10,totalPage:"",pageSize:"",currentPage:1}},methods:{indexMethod:function(e){return 10*(this.currentPage-1)+e+1},getData:function(e,t){var a=this;this.$http.get(e,t).then(function(e){a.total=e.data.data.total,a.totalPage=e.data.data.totalPage,a.pageSize=e.data.data.pageSize,a.currentPage=e.data.data.page;var t=e.data.data.rows;t.length>0&&(a.messageTemplateList=t,a.messageTemplateList.forEach(function(e,t){a.$set(e,"editable",!0),e.updatedTime=a.getTimeStyle(e.updatedTime)}))})},handleCurrentChange:function(e){var t=new URLSearchParams;t.append("page",e),t.append("userId",1),this.getData("/api/message/template_list",{params:t})},serverTypeAdd:function(){var e=this,t=this.totalPage,a=new URLSearchParams;a.append("page",t),a.append("userId",1),this.$http.get("/api/message/template_list",{params:a}).then(function(t){e.total=t.data.data.total,e.totalPage=t.data.data.totalPage,e.pageSize=t.data.data.pageSize,e.currentPage=t.data.data.page;var a=t.data.data.rows;a.length>0&&(e.messageTemplateList=a,e.messageTemplateList.forEach(function(t,a){e.$set(t,"editable",!0),t.updatedTime=e.getTimeStyle(t.updatedTime)})),a.push({editable:!1,addComplete:!0,msgCode:e.total+1})})},editCurrentDate:function(e,t){console.log(e,t),t.editable=!1},completeEdit:function(e,t){var a=this;if(t.addComplete)if(t.msgCode&&t.msgType&&t.templateDetails){var s=new URLSearchParams;s.append("msgCode",t.msgCode),s.append("msgType",t.msgType),s.append("templateDetails",t.templateDetails),this.$http.post("/api/message/template_add",s).then(function(e){a.$alert("请联系技术人员，进一步完成短信服务对接，否则新增的内容无法生效","提示",{confirmButtonText:"确定",callback:function(e){a.$message({message:"恭喜你，添加短信模板成功",type:"success",center:!0});var t=new URLSearchParams;t.append("userId",1),a.getData("/api/message/template_list",{params:t})}})})}else this.$message({message:"很遗憾,代码或服务类型或短信内容不能为空",type:"warning",center:!0});else{var n=new URLSearchParams;n.append("id",t.id),n.append("msgType",t.msgType),n.append("templateDetails",t.templateDetails),this.$http.post("/api/message/template_edit",n).then(function(e){a.$message({message:"恭喜你，修改成功",type:"success",center:!0});var t=new URLSearchParams;t.append("userId",1),a.getData("/api/message/template_list",{params:t})})}}},mounted:function(){var e=new URLSearchParams;e.append("userId",1),this.getData("/api/message/template_list",{params:e})}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"messageTemplatePage"},[a("div",{staticClass:"top",attrs:{id:"messageTem"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",round:""},on:{click:e.serverTypeAdd}},[e._v("新增服务类型")]),e._v(" "),a("p",[e._v("共有"),a("span",[e._v(e._s(e.total))]),e._v("条结果")])],1),e._v(" "),a("div",{staticClass:"tabs-data msgTmplate"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.messageTemplateList}},[a("el-table-column",{attrs:{prop:"msgCode",label:"代码",type:"index",index:e.indexMethod,width:"60"}}),e._v(" "),a("el-table-column",{attrs:{prop:"msgType",label:"服务类型",width:"146"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.messageTemplateList[t.$index].editable?a("span",[e._v(e._s(e.messageTemplateList[t.$index].msgType))]):e._e(),e._v(" "),e.messageTemplateList[t.$index].editable?e._e():a("el-input",{model:{value:e.messageTemplateList[t.$index].msgType,callback:function(a){e.$set(e.messageTemplateList[t.$index],"msgType",a)},expression:"messageTemplateList[scope.$index].msgType"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"templateDetails",label:"短信内容",width:"730"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.messageTemplateList[t.$index].editable?a("span",[e._v(e._s(e.messageTemplateList[t.$index].templateDetails))]):e._e(),e._v(" "),e.messageTemplateList[t.$index].editable?e._e():a("el-input",{model:{value:e.messageTemplateList[t.$index].templateDetails,callback:function(a){e.$set(e.messageTemplateList[t.$index],"templateDetails",a)},expression:"messageTemplateList[scope.$index].templateDetails"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"updatedTime",label:"修改时间",width:"165"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.messageTemplateList[t.$index].updatedTime))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"管理操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.messageTemplateList[t.$index].editable?a("el-button",{attrs:{type:"text",icon:"iconfont icon-xiugai-"},nativeOn:{click:function(a){return e.editCurrentDate(t.$index,t.row)}}},[e._v("修改")]):e._e(),e._v(" "),e.messageTemplateList[t.$index].editable?e._e():a("el-button",{attrs:{type:"text",icon:"iconfont icon-wancheng"},nativeOn:{click:function(a){return e.completeEdit(t.$index,t.row)}}},[e._v("完成")])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{background:"",total:e.total,layout:"prev, pager, next","current-page":e.currentPage},on:{"current-change":e.handleCurrentChange}})],1)])},staticRenderFns:[]};var r={data:function(){return{}},components:{messageCom:a("C7Lr")(s,n,!1,function(e){a("31FK")},"data-v-8ed7909c",null).exports,messageTemplateCom:a("C7Lr")(i,l,!1,function(e){a("Ejdv")},"data-v-a4abe340",null).exports}},p={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"shortMessage commonRight"},[t("el-tabs",{attrs:{type:"border-card"}},[t("el-tab-pane",[t("span",{attrs:{slot:"label"},slot:"label"},[t("i",{staticClass:"iconfont icon-duanxintongzhi"}),this._v("短信通知")]),this._v(" "),t("messageCom")],1),this._v(" "),t("el-tab-pane",[t("span",{attrs:{slot:"label"},slot:"label"},[t("i",{staticClass:"iconfont icon-duanxinmobanguanli"}),this._v("短信模板管理")]),this._v(" "),t("messageTemplateCom")],1)],1)],1)},staticRenderFns:[]};var d=a("C7Lr")(r,p,!1,function(e){a("XA1F")},"data-v-2930afbc",null);t.default=d.exports}});
//# sourceMappingURL=6.fb604dae5926bcbd8f34.js.map